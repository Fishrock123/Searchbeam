/* Â© 2014, Jeremiah Senkpiel, built: 2014-04-16 */
$(document).ready(function(){function a(){var a=this;return i&&(j&&j.abort(),j=$.ajax({type:"POST",url:"/api/v1/auth/register",data:$(a).serialize(),dataType:"json",error:function(){$("#s_submit").parent().children(".icon").addClass("err").removeClass("hidden green")},success:function(b){b.user&&(b.user.valid?(h.user.valid=b.user.valid,$("#s_user").parent().children(".icon").removeClass("err").addClass("green").html("&#xF007;")):(b.user.err&&$("#err_msg").text(b.user.err),$("#s_user").parent().children(".icon").removeClass("green").addClass("err").html("&#xF071;"))),b.pass&&(b.pass.valid?(h.pass.valid=b.pass.valid,$("#s_pass").parent().children(".icon").removeClass("err").addClass("green").html("&#xF084;")):(b.pass.err&&$("#err_msg").text(b.pass.err),$("#s_pass").parent().children(".icon").removeClass("green").addClass("err").html("&#xF071;"))),c(),b.err?(b.err&&$("#err_msg").text(b.err),$("#s_submit").parent().children(".icon").addClass("err").removeClass("hidden green")):b.registered&&($("#s_submit").parent().children(".icon").removeClass("err hidden").addClass("green").html("&#xF00C;"),$("#s_submit").addClass("disabled grayed"),$.ajax({type:"POST",url:"/api/v1/auth/login",data:$(a).serialize(),dataType:"json",error:function(a,b){$("#err_msg").text(b),console.log(b),console.log(a)},success:function(a){a.error?($("#auth-err").show().text(a.error),$("#err_msg").text(a.error)):a.success&&($("#auth-success").show().text(a.success),$("#auth").html(a.html),$(".login").addClass("hidden"),$(".blurable").removeClass("blur"),$("#cover").removeClass("show_cover"),$("#auth").addClass("faint"))},timeout:6e4}))},timeout:1e4})),!1}function b(a){a.data.valid=!1,c(),window.clearTimeout(a.data.timer),a.data.timer=window.setTimeout(a.data.check,1100)}function c(){(i=h.user.valid&&h.pass.valid&&h.conf.valid)?($("#err_msg").text(""),$("#s_submit").removeClass("disabled grayed")):$("#s_submit").addClass("disabled grayed")}function d(){$("#s_user").val().length<1&&$("#s_pass").val().length<1&&$("#err_msg").text("")}function e(){var a,b,e=h.user;a=$("#s_user"),b=a.val(),e.valid=!1,void 0===b||null===b||b.length<1?(d(),a.parent().children(".icon").removeClass("green err").html("&#xF007;")):(e.ajax&&e.ajax.abort(),e.ajax=$.ajax({type:"POST",url:"/api/v1/auth/validate",contentType:"application/json",data:JSON.stringify({username:b}),dataType:"json",error:function(b,c){e.valid=!1,$("#err_msg").text(c),console.log(c),console.log(b),a.parent().children(".icon").removeClass("green").addClass("err").html("&#xF071;")},success:function(b){b.user.valid?(e.valid=b.user.valid,a.parent().children(".icon").removeClass("err").addClass("green").html("&#xF007;")):(e.valid=!1,b.user.err&&$("#err_msg").text(b.user.err),a.parent().children(".icon").removeClass("green").addClass("err").html("&#xF071;")),c()},timeout:5e3}))}function f(){var a,b,e=h.pass;a=$("#s_pass"),b=a.val(),e.valid=!1,g(),void 0===b||null===b||b.length<1?(d(),a.parent().children(".icon").removeClass("green err").html("&#xF084;")):(e.ajax&&e.ajax.abort(),e.ajax=$.ajax({type:"POST",url:"/api/v1/auth/validate",contentType:"application/json",data:JSON.stringify({password:b}),dataType:"json",error:function(b,c){e.valid=!1,$("#err_msg").text(c),console.log(c),console.log(b),a.parent().children(".icon").removeClass("green").addClass("err").html("&#xF071;")},success:function(b){b.pass.valid?(e.valid=b.pass.valid,a.parent().children(".icon").removeClass("err").addClass("green").html("&#xF084;")):(e.valid=!1,b.pass.err&&$("#err_msg").text(b.pass.err),a.parent().children(".icon").removeClass("green").addClass("err").html("&#xF071;")),c()},timeout:5e3}))}function g(){var a,b,d=h.conf;a=$("#s_pass_conf"),b=a.val(),void 0===b||null===b||b.length<1?(d.valid=!1,a.parent().children(".icon").removeClass("green err").addClass("invert").html("&#xF064;")):b!==$("#s_pass").val()?(d.valid=!1,a.parent().children(".icon").removeClass("green invert").addClass("err").html("&#xF119;")):(d.valid=!0,a.parent().children(".icon").removeClass("err invert").addClass("green").html("&#xF00C;")),c()}var h={user:{timer:0,valid:!1,check:e,ajax:void 0},pass:{timer:0,valid:!1,check:f,ajax:void 0},conf:{timer:0,valid:!1,check:g}},i=!1,j=void 0;$("#s_user").on("input",h.user,b),$("#s_pass").on("input",h.pass,b),$("#s_pass_conf").on("input",h.conf,b),$("#signup").submit(a)});